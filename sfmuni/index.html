<!doctype html>
<html><head>
<title>jimmont sf-muni map</title>
<meta charset="utf-8">
<title>SF realtime  locations</title>
<meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">
<style>
html{--dark:#035;}
html, body{background-color:var(--dark);height:100%;width:100%;min-width:320px; -ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;-webkit-font-smoothing: antialiased;-moz-osx-font-smoothing: grayscale;-webkit-tap-highlight-color: transparent;}
body {margin: 0;font-family:system, system-ui, -apple-system, ".SFNSText-Regular", "San Francisco", "Oxygen", "Ubuntu", "Roboto", "Segoe UI", "Helvetica Neue", "Lucida Grande", sans-serif; line-height: 1.3;background-color:#ddd;}
pre, code{font-family:"SF Mono", "Monaco", "Inconsolata", "Fira Mono", "Droid Sans Mono", "Source Code Pro", "Lucida Console", monospace;}
iframe{border: 1;}
</style>
</head><body>
<the-map></the-map>
<script>
// the nextbus api is only available over http
if(location.protocol === 'https:' && confirm('redirect to http?')) location.replace('http:'+location.host+location.pathname);
</script>
<script src="./d3.v5.js"></script>
<script type=module src="the-map.js"></script>
<!--
Jim Montgomery 2018 June 24 jimmont.com
an exercise asked of Steven Craig (scraig) at ThousandEyes
used native web components as framework passing shared model around

to review or comment please visit:
https://codereview.stackexchange.com/questions/197446/map-of-sf-transit-cars
https://gist.github.com/jimmont/2b8c21b9b3810b3662f8f6a63fccc59f

feedback provided via Craig (above) 2018 June 28
Though i like the fact the the candidate used web components (mostly for the newness rather than for web component itself), the challenge is poorly designed: everything is split among two components; no further level of abstraction/structure. These 2 components contain lots of junior patterns (this[ item.routeTag ] ? true : false;), coding style could have been better, and some code repetition that could have been abstracted.

...

First, you will need to display a base map of San Francisco. This zip file contains a few different versions in GeoJSON format: http://downloads.thousandeyes.com/challenge/sfmaps.zip

Next, draw SF Muni vehicle locations on top of the map, dynamically updating their locations every 15 seconds. You can get this information from the NextBus real-time data feed. The documentation is here:
http://www.nextbus.com/xmlFeedDocs/NextBusXMLFeed.pdf

Though it's undocumented, NextBus also provides this feed in JSON format. Just change "XML" to "JSON" in the URL. That is to say, you can use http://webservices.nextbus.com/service/publicJSONFeed instead of http://webservices.nextbus.com/service/publicXMLFeed.

Feel free to get creative with how you draw the vehicles, how you transition them to their latest positions, and so on.

Finally, provide a separate HTML control for selecting a subset of routes (the "routeTag" attribute in the data), for example, show only "N" and "6". Only the vehicles of the selected routes should be drawn on the map.

How To Build It

In addition to d3, you must use a modern web framework such as (but not limited to!) AngularJS, React, Vue, Aurelia, or Angular2.  You are also welcome to use any additional supporting libraries you want. However, please do not use any non-d3 drawing libraries or out-of-the-box mapping packages such as leaflet.js.

Note that the NextBus server allows AJAX requests from all origins, so you can fetch the data directly from your JavaScript code, no backend required.

Submitting Your Solution

It typically takes somewhere between 4 and 8 hours to complete a basic, working version of this challenge. However, as long as you submit your solution within a week, you are welcome to spend as much or as little time on it as you would like. Just keep in mind that we are a lot more interested in well-engineered, production-quality code than we are in visual aesthetics or a fully completed challenge. If you find yourself taking significantly longer than 8 hours to complete a basic, working version, or you simply have no more time to spend on it, please submit what you have so far. We will be happy to evaluate it. Above all, have fun! 

A Note On Results

We’re assessing challenges primarily on the submitted code, not the number of features or level of polish in the UI. We want to get a sense of the quality of the code you’d be contributing here. If you find yourself having to decide between improving the UI or the code, please focus on improving the code! Structure the submission as if it were code that you’d contribute to an application that requires long term maintenance.

What does this mean? Separation of concerns, avoiding redundant code (single sources of truth), human friendly variable naming, modern coding conventions, following best practices of the chosen frameworks, and avoiding real world performance pitfalls should be the primary focus when implementing the challenge.
-->
</body></html>
